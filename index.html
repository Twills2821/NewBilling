<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life Abundantly Billing System</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Lucide React Icons as inline components
        const LucideIcons = {
            Plus: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('path', {d: 'm9 12 2 2 4-4'}),
                React.createElement('path', {d: 'M21 12c.552 0 1-.448 1-1s-.448-1-1-1-1 .448-1 1 .448 1 1 1z'}),
                React.createElement('path', {d: 'M3 12c.552 0 1-.448 1-1s-.448-1-1-1-1 .448-1 1 .448 1 1 1z'}),
                React.createElement('path', {d: 'M12 21c.552 0 1-.448 1-1s-.448-1-1-1-1 .448-1 1 .448 1 1 1z'}),
                React.createElement('path', {d: 'M12 3c.552 0 1-.448 1-1s-.448-1-1-1-1 .448-1 1 .448 1 1 1z'}),
                React.createElement('path', {d: 'M8 8h8v8H8z'})
            ),
            Trash2: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('path', {d: 'M3 6h18'}),
                React.createElement('path', {d: 'M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6'}),
                React.createElement('path', {d: 'M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2'}),
                React.createElement('line', {x1: 10, y1: 11, x2: 10, y2: 17}),
                React.createElement('line', {x1: 14, y1: 11, x2: 14, y2: 17})
            ),
            DollarSign: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('line', {x1: 12, y1: 1, x2: 12, y2: 23}),
                React.createElement('path', {d: 'M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6'})
            ),
            Clock: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('circle', {cx: 12, cy: 12, r: 10}),
                React.createElement('polyline', {points: '12,6 12,12 16,14'})
            ),
            Users: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('path', {d: 'M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2'}),
                React.createElement('circle', {cx: 9, cy: 7, r: 4}),
                React.createElement('path', {d: 'M22 21v-2a4 4 0 0 0-3-3.87'}),
                React.createElement('path', {d: 'M16 3.13a4 4 0 0 1 0 7.75'})
            ),
            Calculator: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('rect', {x: 4, y: 2, width: 16, height: 20, rx: 2}),
                React.createElement('line', {x1: 8, y1: 6, x2: 16, y2: 6}),
                React.createElement('line', {x1: 16, y1: 10, x2: 16, y2: 10}),
                React.createElement('line', {x1: 12, y1: 10, x2: 12, y2: 10}),
                React.createElement('line', {x1: 8, y1: 10, x2: 8, y2: 10}),
                React.createElement('line', {x1: 16, y1: 14, x2: 16, y2: 14}),
                React.createElement('line', {x1: 12, y1: 14, x2: 12, y2: 14}),
                React.createElement('line', {x1: 8, y1: 14, x2: 8, y2: 14}),
                React.createElement('line', {x1: 16, y1: 18, x2: 16, y2: 18}),
                React.createElement('line', {x1: 12, y1: 18, x2: 12, y2: 18}),
                React.createElement('line', {x1: 8, y1: 18, x2: 8, y2: 18})
            ),
            RotateCcw: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('path', {d: 'M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8'}),
                React.createElement('path', {d: 'M3 3v5h5'})
            ),
            FileText: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('path', {d: 'M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z'}),
                React.createElement('polyline', {points: '14,2 14,8 20,8'}),
                React.createElement('line', {x1: 16, y1: 13, x2: 8, y2: 13}),
                React.createElement('line', {x1: 16, y1: 17, x2: 8, y2: 17}),
                React.createElement('polyline', {points: '10,9 9,9 8,9'})
            ),
            AlertCircle: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('circle', {cx: 12, cy: 12, r: 10}),
                React.createElement('line', {x1: 12, y1: 8, x2: 12, y2: 12}),
                React.createElement('line', {x1: 12, y1: 16, x2: 12.01, y2: 16})
            ),
            CheckCircle: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('path', {d: 'M22 11.08V12a10 10 0 1 1-5.93-9.14'}),
                React.createElement('polyline', {points: '22,4 12,14.01 9,11.01'})
            ),
            User: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('path', {d: 'M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2'}),
                React.createElement('circle', {cx: 12, cy: 7, r: 4})
            ),
            Calendar: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('rect', {x: 3, y: 4, width: 18, height: 18, rx: 2, ry: 2}),
                React.createElement('line', {x1: 16, y1: 2, x2: 16, y2: 6}),
                React.createElement('line', {x1: 8, y1: 2, x2: 8, y2: 6}),
                React.createElement('line', {x1: 3, y1: 10, x2: 21, y2: 10})
            ),
            Eye: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('path', {d: 'M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z'}),
                React.createElement('circle', {cx: 12, cy: 12, r: 3})
            ),
            EyeOff: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('path', {d: 'M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24'}),
                React.createElement('line', {x1: 1, y1: 1, x2: 23, y2: 23})
            ),
            Lock: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('rect', {x: 3, y: 11, width: 18, height: 11, rx: 2, ry: 2}),
                React.createElement('circle', {cx: 12, cy: 16, r: 1}),
                React.createElement('path', {d: 'M7 11V7a5 5 0 0 1 10 0v4'})
            ),
            X: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('line', {x1: 18, y1: 6, x2: 6, y2: 18}),
                React.createElement('line', {x1: 6, y1: 6, x2: 18, y2: 18})
            ),
            Search: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('circle', {cx: 11, cy: 11, r: 8}),
                React.createElement('path', {d: 'M21 21l-4.35-4.35'})
            ),
            Download: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('path', {d: 'M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4'}),
                React.createElement('polyline', {points: '7,10 12,15 17,10'}),
                React.createElement('line', {x1: 12, y1: 15, x2: 12, y2: 3})
            ),
            TrendingUp: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('polyline', {points: '22,7 13.5,15.5 8.5,10.5 2,17'}),
                React.createElement('polyline', {points: '16,7 22,7 22,13'})
            ),
            Bell: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('path', {d: 'M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9'}),
                React.createElement('path', {d: 'M13.73 21a2 2 0 0 1-3.46 0'})
            ),
            Filter: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('polygon', {points: '22,3 2,3 10,12.46 10,19 14,21 14,12.46'})
            ),
            Upload: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('path', {d: 'M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4'}),
                React.createElement('polyline', {points: '17,8 12,3 7,8'}),
                React.createElement('line', {x1: 12, y1: 3, x2: 12, y2: 15})
            ),
            Save: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('path', {d: 'M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z'}),
                React.createElement('polyline', {points: '17,21 17,13 7,13 7,21'}),
                React.createElement('polyline', {points: '7,3 7,8 15,8'})
            ),
            Database: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('ellipse', {cx: 12, cy: 5, rx: 9, ry: 3}),
                React.createElement('path', {d: 'M21 12c0 1.66-4 3-9 3s-9-1.34-9-3'}),
                React.createElement('path', {d: 'M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5'})
            ),
            Heart: () => React.createElement('svg', {width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round'}, 
                React.createElement('path', {d: 'M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z'})
            )
        };

        // Make icons available globally
        Object.keys(LucideIcons).forEach(iconName => {
            window[iconName] = LucideIcons[iconName];
        });
    </script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function LifeAbundantlyBillingSystem() {
            const [clients, setClients] = useState([
                { id: 1, name: 'Author Carr', insurance: 'HealthyBlue', status: '1st Note Submitted 8/8/25', contracted: true, specialNotes: 'Regular attendance, good progress', serviceType: 'SACOT' },
                { id: 2, name: 'Braxton Holiday', insurance: 'Carolina Complete', status: '1st Note Submitted 8/8/25 Processed', contracted: true, specialNotes: 'Processed successfully', serviceType: 'SACOT' },
                { id: 3, name: 'Carl Faison', insurance: 'Carolina Complete', status: '1st Note Not Yet Submitted', contracted: true, specialNotes: 'Need to submit initial documentation', serviceType: 'SACOT' },
                { id: 4, name: 'Coyderra Williams', insurance: 'Alliance', status: '1st Note Submitted 8/8/25', contracted: true, specialNotes: '', serviceType: 'SACOT' },
                { id: 5, name: 'Damari Harper', insurance: 'AmeriHealth', status: '1st Note Submitted 8/8/25', contracted: true, specialNotes: '', serviceType: 'SACOT' },
                { id: 6, name: 'David Taborn', insurance: 'Alliance', status: '1st Note Submitted 8/8/25', contracted: true, specialNotes: '', serviceType: 'SAIOP' },
                { id: 7, name: 'Eugene Williams', insurance: 'AmeriHealth', status: '1st Note Submitted 8/8/25', contracted: true, specialNotes: '', serviceType: 'SACOT' },
                { id: 8, name: 'Iran El Bey', insurance: 'BCBS NC', status: 'Concerned about Peer Placement', contracted: true, specialNotes: 'Monitor peer placement status', serviceType: 'SACOT' },
                { id: 9, name: 'Joseph Patterson', insurance: 'Vaya', status: 'Submitted 7/1-8/4 Both Denied - Not in contract', contracted: false, specialNotes: 'Contract negotiation needed', serviceType: 'SACOT' },
                { id: 10, name: 'Kemp Nichols', insurance: 'BCBS NC', status: 'Billed 7/1-8/4', contracted: true, specialNotes: '', serviceType: 'SACOT' },
                { id: 11, name: 'Kenneth Charles Wilson', insurance: 'Alliance', status: '1st Note Submitted 8/8/25', contracted: true, specialNotes: '', serviceType: 'SACOT' },
                { id: 12, name: 'Lucian Deberry', insurance: 'AmeriHealth', status: '1st Note Submitted 8/8/25', contracted: true, specialNotes: '', serviceType: 'SACOT' },
                { id: 13, name: 'Lindel Wynn', insurance: 'BCBS NC', status: 'Billed 7/1-8', contracted: true, specialNotes: '', serviceType: 'SACOT' },
                { id: 14, name: 'Raymond Addae', insurance: 'UHC', status: 'Not Currently Contracted', contracted: false, specialNotes: 'Awaiting contract approval', serviceType: 'SACOT' },
                { id: 15, name: 'Rodney Jones Sr', insurance: 'Alliance', status: '1st Note Submitted 8/8/25', contracted: true, specialNotes: '', serviceType: 'SACOT' },
                { id: 16, name: 'Sade Knox', insurance: 'Alliance', status: '1st Note Submitted 8/8/25', contracted: true, specialNotes: '', serviceType: 'SAIOP' },
                { id: 17, name: 'Shacora Parker', insurance: 'BCBS NC', status: '1st Note Submitted 8/8/25', contracted: true, specialNotes: '', serviceType: 'SACOT' },
                { id: 18, name: 'Tatayanna Dail', insurance: 'AmeriHealth', status: '1st Note Submitted 7/1/25-8/4', contracted: true, specialNotes: '', serviceType: 'SACOT' },
                { id: 19, name: 'Timothy Poole', insurance: 'Carolina Complete', status: '1st Note Submitted 8/8/25 Processed', contracted: true, specialNotes: 'Processed successfully', serviceType: 'SACOT' },
                { id: 20, name: 'Trevarius Eaddy', insurance: 'AmeriHealth', status: '1st Note Submitted 8/8/25', contracted: true, specialNotes: '', serviceType: 'SACOT' }
            ]);

            const [weeklyData, setWeeklyData] = useState([]);
            const [currentWeek, setCurrentWeek] = useState('2025-08-10');
            const [sacotHourlyRate] = useState(58.61);
            const [saiopDailyRate] = useState(170.03);
            const [selectedTab, setSelectedTab] = useState('overview');
            const [showFinancials, setShowFinancials] = useState(false);
            const [showPasswordModal, setShowPasswordModal] = useState(false);
            const [passwordInput, setPasswordInput] = useState('');
            const [financialPassword] = useState('1234');
            const [lastSaved, setLastSaved] = useState(new Date());
            const [notifications, setNotifications] = useState([]);
            const [showExportModal, setShowExportModal] = useState(false);
            const [selectedWeekIndex, setSelectedWeekIndex] = useState(0);

            // Browser Storage Functions - Auto-save and Auto-load
            useEffect(() => {
                // Load saved data on startup
                const savedClients = localStorage.getItem('lifeAbundantly_clients');
                const savedWeeklyData = localStorage.getItem('lifeAbundantly_weeklyData');
                
                if (savedClients) {
                    try {
                        const parsedClients = JSON.parse(savedClients);
                        setClients(parsedClients);
                    } catch (error) {
                        console.log('Error loading clients:', error);
                    }
                }
                
                if (savedWeeklyData) {
                    try {
                        const parsedWeeklyData = JSON.parse(savedWeeklyData);
                        setWeeklyData(parsedWeeklyData);
                    } catch (error) {
                        console.log('Error loading weekly data:', error);
                    }
                }
            }, []);

            // Auto-save clients whenever they change
            useEffect(() => {
                localStorage.setItem('lifeAbundantly_clients', JSON.stringify(clients));
            }, [clients]);

            // Auto-save weekly data whenever it changes
            useEffect(() => {
                localStorage.setItem('lifeAbundantly_weeklyData', JSON.stringify(weeklyData));
            }, [weeklyData]);

            useEffect(() => {
                checkDeadlines();
            }, [weeklyData]);

            const checkDeadlines = () => {
                const newNotifications = [];
                const today = new Date();
                
                weeklyData.forEach((week, index) => {
                    const weekEnd = new Date(week.weekEnd);
                    const sundayAfter = new Date(weekEnd.getTime() + 2 * 24 * 60 * 60 * 1000);
                    const incompleteTasks = week.clients.filter(client => {
                        return !client.notes || client.notes.trim() === '' || client.totalValue === 0;
                    });
                    
                    if (incompleteTasks.length > 0) {
                        if (today > sundayAfter) {
                            newNotifications.push({
                                id: `deadline-${index}`,
                                type: 'error',
                                message: `Week ${new Date(week.weekStart).toLocaleDateString()} - ${incompleteTasks.length} clients missing notes (OVERDUE)`,
                                count: incompleteTasks.length
                            });
                        } else if (today >= new Date(sundayAfter.getTime() - 2 * 24 * 60 * 60 * 1000)) {
                            newNotifications.push({
                                id: `warning-${index}`,
                                type: 'warning',
                                message: `Week ${new Date(week.weekStart).toLocaleDateString()} - ${incompleteTasks.length} clients missing notes (Due Sunday)`,
                                count: incompleteTasks.length
                            });
                        }
                    }
                });
                
                setNotifications(newNotifications);
            };

            const calculateRevenueForecast = () => {
                if (weeklyData.length < 2) return null;
                
                const recentWeeks = weeklyData.slice(-4);
                const avgWeeklyRevenue = recentWeeks.reduce((sum, week) => {
                    const weekTotal = calculateWeekTotals(week);
                    return sum + weekTotal.totalBilling;
                }, 0) / recentWeeks.length;
                
                return {
                    weeklyAverage: avgWeeklyRevenue,
                    monthlyForecast: avgWeeklyRevenue * 4.33,
                    quarterlyForecast: avgWeeklyRevenue * 13
                };
            };

            const exportToCSV = () => {
                const csvContent = generateCSVContent();
                downloadFile(csvContent, 'text/csv', `Life_Abundantly_Report_${new Date().toISOString().split('T')[0]}.csv`);
                setShowExportModal(false);
            };

            const exportToJSON = () => {
                const dataToExport = {
                    clients,
                    weeklyData,
                    exportDate: new Date().toISOString(),
                    version: '2.0'
                };
                const jsonContent = JSON.stringify(dataToExport, null, 2);
                downloadFile(jsonContent, 'application/json', `Life_Abundantly_Backup_${new Date().toISOString().split('T')[0]}.json`);
                setShowExportModal(false);
            };

            const downloadFile = (content, mimeType, filename) => {
                const blob = new Blob([content], { type: mimeType });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            };

            const generateCSVContent = () => {
                let content = 'Week Start,Week End,Client Name,Insurance,Service Type,Monday,Tuesday,Wednesday,Thursday,Friday,Total,Billing Amount,Payment Status,Notes\n';
                
                weeklyData.forEach(week => {
                    week.clients.forEach(client => {
                        const totalLabel = client.serviceType === 'SACOT' ? `${client.totalValue} hours` : `${client.totalValue} days`;
                        content += `${week.weekStart},${week.weekEnd},"${client.name}","${client.insurance}",${client.serviceType},${client.mondayValue || 0},${client.tuesdayValue || 0},${client.wednesdayValue || 0},${client.thursdayValue || 0},${client.fridayValue || 0},${totalLabel},${client.billing || 0},${client.paymentStatus || 'Pending'},"${(client.notes || '').replace(/"/g, '""')}"\n`;
                    });
                });
                
                return content;
            };

            const clearFinancialData = () => {
                const confirmed = window.confirm('Are you sure you want to permanently clear all financial data? This will keep service hours but remove billing amounts and cannot be undone.');
                if (confirmed) {
                    const updatedWeeks = weeklyData.map(week => ({
                        ...week,
                        clients: week.clients.map(client => ({
                            ...client,
                            billing: 0
                        }))
                    }));
                    setWeeklyData(updatedWeeks);
                    setLastSaved(new Date());
                }
            };

            const clearAllData = () => {
                const confirmed = window.confirm('Are you sure you want to clear ALL data? This will remove all clients, weeks, and billing information and cannot be undone.');
                if (confirmed) {
                    setClients([]);
                    setWeeklyData([]);
                    setLastSaved(new Date());
                }
            };

            const addWeek = () => {
                if (!currentWeek) return;
                
                const newWeekData = {
                    weekStart: currentWeek,
                    weekEnd: new Date(new Date(currentWeek).getTime() + 6 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    clients: clients.map(client => ({
                        clientId: client.id,
                        name: client.name,
                        insurance: client.insurance,
                        serviceType: client.serviceType,
                        mondayValue: client.serviceType === 'SACOT' ? 0 : false,
                        tuesdayValue: client.serviceType === 'SACOT' ? 0 : false,
                        wednesdayValue: client.serviceType === 'SACOT' ? 0 : false,
                        thursdayValue: client.serviceType === 'SACOT' ? 0 : false,
                        fridayValue: client.serviceType === 'SACOT' ? 0 : false,
                        totalValue: 0,
                        billing: 0,
                        notes: '',
                        paymentStatus: 'Pending'
                    }))
                };
                
                setWeeklyData([...weeklyData, newWeekData]);
                setSelectedTab('billing');
                setSelectedWeekIndex(weeklyData.length); // Set to the new week index
                setLastSaved(new Date());
            };

            const updateClientValue = (weekIndex, clientIndex, day, value) => {
                const updatedWeeks = [...weeklyData];
                const client = updatedWeeks[weekIndex].clients[clientIndex];
                client[`${day}Value`] = client.serviceType === 'SACOT' ? (parseFloat(value) || 0) : value;
                
                if (client.serviceType === 'SACOT') {
                    client.totalValue = client.mondayValue + client.tuesdayValue + 
                                     client.wednesdayValue + client.thursdayValue + client.fridayValue;
                    client.billing = client.totalValue * sacotHourlyRate;
                } else {
                    client.totalValue = [
                        client.mondayValue,
                        client.tuesdayValue,
                        client.wednesdayValue,
                        client.thursdayValue,
                        client.fridayValue
                    ].filter(Boolean).length;
                    client.billing = client.totalValue * saiopDailyRate;
                }
                
                setWeeklyData(updatedWeeks);
                setLastSaved(new Date());
            };

            const updateClientNotes = (weekIndex, clientIndex, notes) => {
                const updatedWeeks = [...weeklyData];
                updatedWeeks[weekIndex].clients[clientIndex].notes = notes;
                setWeeklyData(updatedWeeks);
                setLastSaved(new Date());
            };

            const updatePaymentStatus = (weekIndex, clientIndex, status) => {
                const updatedWeeks = [...weeklyData];
                updatedWeeks[weekIndex].clients[clientIndex].paymentStatus = status;
                setWeeklyData(updatedWeeks);
                setLastSaved(new Date());
            };

            const removeWeek = (weekIndex) => {
                if (window.confirm('Are you sure you want to delete this week? This action cannot be undone.')) {
                    const updatedWeeks = weeklyData.filter((_, index) => index !== weekIndex);
                    setWeeklyData(updatedWeeks);
                    // Adjust selectedWeekIndex if necessary
                    if (selectedWeekIndex >= updatedWeeks.length && updatedWeeks.length > 0) {
                        setSelectedWeekIndex(updatedWeeks.length - 1);
                    } else if (updatedWeeks.length === 0) {
                        setSelectedWeekIndex(0);
                    }
                    setLastSaved(new Date());
                }
            };

            const toggleFinancialVisibility = () => {
                if (showFinancials) {
                    setShowFinancials(false);
                } else {
                    setShowPasswordModal(true);
                    setPasswordInput('');
                }
            };

            const handlePasswordSubmit = () => {
                if (passwordInput === financialPassword) {
                    setShowFinancials(true);
                    setShowPasswordModal(false);
                    setPasswordInput('');
                } else {
                    alert('Incorrect password. Please try again.');
                    setPasswordInput('');
                }
            };

            const calculateWeekTotals = (week) => {
                const sacotHours = week.clients.filter(c => c.serviceType === 'SACOT').reduce((sum, client) => sum + (client.totalValue || 0), 0);
                const sacotBilling = week.clients.filter(c => c.serviceType === 'SACOT').reduce((sum, client) => sum + (client.billing || 0), 0);
                const saiopDays = week.clients.filter(c => c.serviceType === 'SAIOP').reduce((sum, client) => sum + (client.totalValue || 0), 0);
                const saiopBilling = week.clients.filter(c => c.serviceType === 'SAIOP').reduce((sum, client) => sum + (client.billing || 0), 0);
                const totalBilling = sacotBilling + saiopBilling;
                
                return { sacotHours, sacotBilling, saiopDays, saiopBilling, totalBilling };
            };

            const calculateGrandTotals = () => {
                return weeklyData.reduce((acc, week) => {
                    const weekTotal = calculateWeekTotals(week);
                    return {
                        sacotHours: acc.sacotHours + weekTotal.sacotHours,
                        sacotBilling: acc.sacotBilling + weekTotal.sacotBilling,
                        saiopDays: acc.saiopDays + weekTotal.saiopDays,
                        saiopBilling: acc.saiopBilling + weekTotal.saiopBilling,
                        totalBilling: acc.totalBilling + weekTotal.totalBilling
                    };
                }, { sacotHours: 0, sacotBilling: 0, saiopDays: 0, saiopBilling: 0, totalBilling: 0 });
            };

            const addClient = () => {
                const newClient = {
                    id: Math.max(...clients.map(c => c.id)) + 1,
                    name: 'New Client',
                    insurance: 'TBD',
                    status: 'Pending',
                    contracted: true,
                    specialNotes: '',
                    serviceType: 'SACOT'
                };
                setClients([...clients, newClient]);
                setLastSaved(new Date());
            };

            const updateClient = (clientId, field, value) => {
                const updatedClients = clients.map(client => 
                    client.id === clientId ? { ...client, [field]: value } : client
                );
                setClients(updatedClients);
                setLastSaved(new Date());
            };

            const removeClient = (clientId) => {
                if (window.confirm('Are you sure you want to remove this client?')) {
                    const updatedClients = clients.filter(client => client.id !== clientId);
                    setClients(updatedClients);
                    setLastSaved(new Date());
                }
            };

            const getInsuranceColor = (insurance) => {
                const colors = {
                    'Alliance': 'bg-blue-100 text-blue-800',
                    'AmeriHealth': 'bg-green-100 text-green-800',
                    'BCBS NC': 'bg-purple-100 text-purple-800',
                    'Carolina Complete': 'bg-orange-100 text-orange-800',
                    'HealthyBlue': 'bg-cyan-100 text-cyan-800',
                    'Vaya': 'bg-pink-100 text-pink-800',
                    'UHC': 'bg-gray-100 text-gray-800'
                };
                return colors[insurance] || 'bg-gray-100 text-gray-800';
            };

            const getServiceTypeColor = (serviceType) => {
                return serviceType === 'SACOT' 
                    ? 'bg-emerald-100 text-emerald-800' 
                    : 'bg-violet-100 text-violet-800';
            };

            const getPaymentStatusColor = (status) => {
                const colors = {
                    'Paid': 'bg-green-100 text-green-800',
                    'Pending': 'bg-yellow-100 text-yellow-800',
                    'Denied': 'bg-red-100 text-red-800'
                };
                return colors[status] || 'bg-gray-100 text-gray-800';
            };

            const getStatusIcon = (contracted, status) => {
                if (!contracted) return React.createElement(AlertCircle, {className: "h-4 w-4 text-red-500"});
                if (status.includes('Processed') || status.includes('Billed')) return React.createElement(CheckCircle, {className: "h-4 w-4 text-green-500"});
                return React.createElement(Clock, {className: "h-4 w-4 text-yellow-500"});
            };

            const grandTotals = calculateGrandTotals();
            const contractedClients = clients.filter(c => c.contracted).length;
            const sacotClients = clients.filter(c => c.serviceType === 'SACOT').length;
            const saiopClients = clients.filter(c => c.serviceType === 'SAIOP').length;

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-50 to-blue-50">
                    {/* Password Modal */}
                    {showPasswordModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            <div className="bg-white rounded-2xl p-8 shadow-2xl border border-slate-200 max-w-md w-full mx-4">
                                <div className="flex items-center justify-between mb-6">
                                    <div className="flex items-center space-x-3">
                                        {React.createElement(Lock, {className: "h-6 w-6 text-blue-600"})}
                                        <h3 className="text-xl font-bold text-slate-800">Enter Password</h3>
                                    </div>
                                    <button
                                        onClick={() => setShowPasswordModal(false)}
                                        className="text-slate-400 hover:text-slate-600 transition-colors"
                                    >
                                        {React.createElement(X, {className: "h-6 w-6"})}
                                    </button>
                                </div>
                                
                                <p className="text-slate-600 mb-6">
                                    Please enter the 4-digit password to view financial data.
                                </p>
                                
                                <div className="mb-6">
                                    <input
                                        type="password"
                                        value={passwordInput}
                                        onChange={(e) => setPasswordInput(e.target.value)}
                                        onKeyPress={(e) => e.key === 'Enter' && handlePasswordSubmit()}
                                        placeholder="••••"
                                        maxLength="4"
                                        className="w-full p-4 text-center text-2xl tracking-widest border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                        autoFocus
                                    />
                                </div>
                                
                                <div className="flex space-x-3">
                                    <button
                                        onClick={() => setShowPasswordModal(false)}
                                        className="flex-1 px-6 py-3 border border-slate-300 text-slate-700 rounded-xl hover:bg-slate-50 transition-colors"
                                    >
                                        Cancel
                                    </button>
                                    <button
                                        onClick={handlePasswordSubmit}
                                        className="flex-1 px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-200"
                                    >
                                        Unlock
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Export Modal */}
                    {showExportModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            <div className="bg-white rounded-2xl p-8 shadow-2xl border border-slate-200 max-w-md w-full mx-4">
                                <div className="flex items-center justify-between mb-6">
                                    <div className="flex items-center space-x-3">
                                        {React.createElement(Download, {className: "h-6 w-6 text-green-600"})}
                                        <h3 className="text-xl font-bold text-slate-800">Export Data</h3>
                                    </div>
                                    <button
                                        onClick={() => setShowExportModal(false)}
                                        className="text-slate-400 hover:text-slate-600 transition-colors"
                                    >
                                        {React.createElement(X, {className: "h-6 w-6"})}
                                    </button>
                                </div>
                                
                                <p className="text-slate-600 mb-6">
                                    Choose your export format for the billing data.
                                </p>
                                
                                <div className="space-y-3">
                                    <button
                                        onClick={exportToCSV}
                                        className="w-full p-4 text-left border border-slate-300 rounded-xl hover:bg-slate-50 transition-colors"
                                    >
                                        <div className="font-semibold">CSV Spreadsheet</div>
                                        <div className="text-sm text-slate-600">Excel-compatible format with all billing data</div>
                                    </button>
                                    <button
                                        onClick={exportToJSON}
                                        className="w-full p-4 text-left border border-slate-300 rounded-xl hover:bg-slate-50 transition-colors"
                                    >
                                        <div className="font-semibold">JSON Backup</div>
                                        <div className="text-sm text-slate-600">Complete backup file (can be imported later)</div>
                                    </button>
                                    <button
                                        onClick={() => {
                                            alert('PDF export will be available in the next update!');
                                            setShowExportModal(false);
                                        }}
                                        className="w-full p-4 text-left border border-slate-300 rounded-xl hover:bg-slate-50 transition-colors"
                                    >
                                        <div className="font-semibold">PDF Report</div>
                                        <div className="text-sm text-slate-600">Professional formatted report</div>
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="max-w-7xl mx-auto p-6">
                        {/* Header */}
                        <div className="bg-white rounded-2xl shadow-xl p-8 mb-8 border border-slate-200">
                            <div className="flex items-center justify-between mb-6">
                                <div className="flex items-center space-x-4">
                                    {React.createElement(Heart, {className: "h-12 w-12 text-rose-500"})}
                                    <div>
                                        <h1 className="text-4xl font-bold bg-gradient-to-r from-rose-600 to-purple-600 bg-clip-text text-transparent">
                                            Life Abundantly
                                        </h1>
                                        <p className="text-slate-600 mt-1 text-lg">Comprehensive Billing Management System</p>
                                        <div className="flex items-center mt-2 space-x-4">
                                            <span className="bg-emerald-100 text-emerald-700 px-3 py-1 rounded-full text-sm font-medium">
                                                SACOT: H2035 - ${sacotHourlyRate}/hr
                                            </span>
                                            <span className="bg-violet-100 text-violet-700 px-3 py-1 rounded-full text-sm font-medium">
                                                SAIOP: H0015 - ${saiopDailyRate}/day
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="flex items-center space-x-4">
                                    <button
                                        onClick={() => setShowExportModal(true)}
                                        className="flex items-center px-4 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors"
                                    >
                                        {React.createElement(Download, {className: "h-4 w-4 mr-2"})}
                                        Export
                                    </button>
                                    
                                    <div className="flex items-center text-sm text-slate-500">
                                        {React.createElement(Save, {className: "h-4 w-4 mr-1"})}
                                        <span>Saved {lastSaved.toLocaleTimeString()}</span>
                                    </div>
                                    
                                    {notifications.length > 0 && (
                                        <div className="relative">
                                            {React.createElement(Bell, {className: "h-6 w-6 text-red-500"})}
                                            <span className="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">
                                                {notifications.length}
                                            </span>
                                        </div>
                                    )}
                                </div>
                            </div>

                            {/* Notifications Panel */}
                            {notifications.length > 0 && (
                                <div className="mb-6 space-y-2">
                                    {notifications.map(notification => (
                                        <div
                                            key={notification.id}
                                            className={`p-4 rounded-xl border-l-4 ${
                                                notification.type === 'error' 
                                                    ? 'bg-red-50 border-red-500 text-red-800' 
                                                    : 'bg-yellow-50 border-yellow-500 text-yellow-800'
                                            }`}
                                        >
                                            <div className="flex items-center">
                                                {notification.type === 'error' ? 
                                                    React.createElement(AlertCircle, {className: "h-5 w-5 mr-2"}) :
                                                    React.createElement(Clock, {className: "h-5 w-5 mr-2"})
                                                }
                                                <span className="font-medium">{notification.message}</span>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}

                            {/* Revenue Projections Panel */}
                            {showFinancials && weeklyData.length >= 2 && (
                                <div className="bg-gradient-to-r from-slate-100 to-blue-100 rounded-xl p-6 mb-6">
                                    <div className="flex items-center mb-4">
                                        {React.createElement(TrendingUp, {className: "h-6 w-6 text-blue-600 mr-3"})}
                                        <h3 className="text-xl font-bold text-slate-800">Revenue Projections</h3>
                                    </div>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                        {(() => {
                                            const forecast = calculateRevenueForecast();
                                            return forecast ? (
                                                <>
                                                    <div className="text-center">
                                                        <div className="text-3xl font-bold text-blue-600">
                                                            ${forecast.weeklyAverage.toLocaleString('en-US', {minimumFractionDigits: 0})}
                                                        </div>
                                                        <div className="text-slate-600 font-medium">Weekly Average</div>
                                                        <div className="text-sm text-slate-500">Last 4 weeks</div>
                                                    </div>
                                                    <div className="text-center">
                                                        <div className="text-3xl font-bold text-green-600">
                                                            ${forecast.monthlyForecast.toLocaleString('en-US', {minimumFractionDigits: 0})}
                                                        </div>
                                                        <div className="text-slate-600 font-medium">Monthly Projection</div>
                                                        <div className="text-sm text-slate-500">4.33 weeks</div>
                                                    </div>
                                                    <div className="text-center">
                                                        <div className="text-3xl font-bold text-purple-600">
                                                            ${forecast.quarterlyForecast.toLocaleString('en-US', {minimumFractionDigits: 0})}
                                                        </div>
                                                        <div className="text-slate-600 font-medium">Quarterly Projection</div>
                                                        <div className="text-sm text-slate-500">13 weeks</div>
                                                    </div>
                                                </>
                                            ) : null;
                                        })()}
                                    </div>
                                </div>
                            )}

                            {/* Summary Cards */}
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4 mb-6">
                                <div className="bg-gradient-to-br from-blue-500 to-blue-600 p-6 rounded-xl text-white">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <div className="text-3xl font-bold">{clients.length}</div>
                                            <div className="text-blue-100 text-sm">Total Clients</div>
                                            <div className="text-xs text-blue-200 mt-1">{contractedClients} contracted</div>
                                        </div>
                                        {React.createElement(Users, {className: "h-12 w-12 text-blue-200"})}
                                    </div>
                                </div>
                                
                                <div className="bg-gradient-to-br from-emerald-500 to-emerald-600 p-6 rounded-xl text-white">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <div className="text-3xl font-bold">{sacotClients}</div>
                                            <div className="text-emerald-100 text-sm">SACOT Clients</div>
                                            <div className="text-xs text-emerald-200 mt-1">{grandTotals.sacotHours.toFixed(1)} hours</div>
                                        </div>
                                        {React.createElement(Clock, {className: "h-12 w-12 text-emerald-200"})}
                                    </div>
                                </div>
                                
                                <div className="bg-gradient-to-br from-violet-500 to-violet-600 p-6 rounded-xl text-white">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <div className="text-3xl font-bold">{saiopClients}</div>
                                            <div className="text-violet-100 text-sm">SAIOP Clients</div>
                                            <div className="text-xs text-violet-200 mt-1">{grandTotals.saiopDays} days</div>
                                        </div>
                                        {React.createElement(Calendar, {className: "h-12 w-12 text-violet-200"})}
                                    </div>
                                </div>
                                
                                <div className="bg-gradient-to-br from-rose-500 to-rose-600 p-6 rounded-xl text-white">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <div className="text-2xl font-bold">
                                                {showFinancials ? `$${grandTotals.sacotBilling.toLocaleString('en-US', {minimumFractionDigits: 0})}` : '••••••'}
                                            </div>
                                            <div className="text-rose-100 text-sm">SACOT Revenue</div>
                                            <div className="text-xs text-rose-200 mt-1">
                                                {showFinancials ? 'Hourly billing' : 'Hidden'}
                                            </div>
                                        </div>
                                        {React.createElement(DollarSign, {className: "h-12 w-12 text-rose-200"})}
                                    </div>
                                </div>
                                
                                <div className="bg-gradient-to-br from-purple-500 to-purple-600 p-6 rounded-xl text-white">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <div className="text-2xl font-bold">
                                                {showFinancials ? `$${grandTotals.saiopBilling.toLocaleString('en-US', {minimumFractionDigits: 0})}` : '••••••'}
                                            </div>
                                            <div className="text-purple-100 text-sm">SAIOP Revenue</div>
                                            <div className="text-xs text-purple-200 mt-1">
                                                {showFinancials ? 'Daily billing' : 'Hidden'}
                                            </div>
                                        </div>
                                        {React.createElement(Calculator, {className: "h-12 w-12 text-purple-200"})}
                                    </div>
                                </div>

                                <div className="bg-gradient-to-br from-green-500 to-green-600 p-6 rounded-xl text-white">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <div className="text-2xl font-bold">
                                                {showFinancials ? `$${grandTotals.totalBilling.toLocaleString('en-US', {minimumFractionDigits: 0})}` : '••••••'}
                                            </div>
                                            <div className="text-green-100 text-sm">Total Revenue</div>
                                            <div className="text-xs text-green-200 mt-1">
                                                {showFinancials ? 'Combined billing' : 'Hidden'}
                                            </div>
                                        </div>
                                        {React.createElement(DollarSign, {className: "h-12 w-12 text-green-200"})}
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Navigation Tabs */}
                        <div className="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden mb-8">
                            <div className="flex border-b border-slate-200">
                                <button
                                    onClick={() => setSelectedTab('overview')}
                                    className={`px-6 py-4 text-sm font-medium flex items-center space-x-2 ${
                                        selectedTab === 'overview' 
                                            ? 'border-b-2 border-rose-500 text-rose-600 bg-rose-50' 
                                            : 'text-slate-500 hover:text-slate-700'
                                    }`}
                                >
                                    {React.createElement(Users, {className: "h-4 w-4"})}
                                    <span>Client Management</span>
                                </button>
                                <button
                                    onClick={() => setSelectedTab('billing')}
                                    className={`px-6 py-4 text-sm font-medium flex items-center space-x-2 ${
                                        selectedTab === 'billing' 
                                            ? 'border-b-2 border-rose-500 text-rose-600 bg-rose-50' 
                                            : 'text-slate-500 hover:text-slate-700'
                                    }`}
                                >
                                    {React.createElement(Calculator, {className: "h-4 w-4"})}
                                    <span>Weekly Billing</span>
                                </button>
                            </div>

                            <div className="p-8">
                                {selectedTab === 'overview' && (
                                    <div>
                                        <div className="flex justify-between items-center mb-6">
                                            <div>
                                                <h2 className="text-2xl font-bold text-slate-800">Client Management</h2>
                                                <p className="text-slate-600">Manage all your clients and their information</p>
                                            </div>
                                            <button
                                                onClick={addClient}
                                                className="flex items-center px-6 py-3 bg-gradient-to-r from-rose-500 to-rose-600 text-white rounded-xl hover:from-rose-600 hover:to-rose-700 shadow-lg transition-all duration-200"
                                            >
                                                {React.createElement(Plus, {className: "h-5 w-5 mr-2"})}
                                                Add New Client
                                            </button>
                                        </div>
                                        
                                        <div className="grid gap-6">
                                            {clients.map((client) => (
                                                <div key={client.id} className="bg-slate-50 rounded-xl p-6 border border-slate-200 hover:shadow-lg transition-all duration-200">
                                                    <div className="grid grid-cols-1 lg:grid-cols-6 gap-4 items-start">
                                                        <div className="lg:col-span-2">
                                                            <label className="block text-sm font-medium text-slate-700 mb-2">Client Name</label>
                                                            <div className="flex items-center space-x-3">
                                                                {React.createElement(User, {className: "h-5 w-5 text-slate-400"})}
                                                                <input
                                                                    type="text"
                                                                    value={client.name}
                                                                    onChange={(e) => updateClient(client.id, 'name', e.target.value)}
                                                                    className="flex-1 p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500"
                                                                />
                                                            </div>
                                                        </div>
                                                        
                                                        <div>
                                                            <label className="block text-sm font-medium text-slate-700 mb-2">Service Type</label>
                                                            <select
                                                                value={client.serviceType}
                                                                onChange={(e) => updateClient(client.id, 'serviceType', e.target.value)}
                                                                className="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500"
                                                            >
                                                                <option value="SACOT">SACOT</option>
                                                                <option value="SAIOP">SAIOP</option>
                                                            </select>
                                                        </div>
                                                        
                                                        <div>
                                                            <label className="block text-sm font-medium text-slate-700 mb-2">Insurance</label>
                                                            <select
                                                                value={client.insurance}
                                                                onChange={(e) => updateClient(client.id, 'insurance', e.target.value)}
                                                                className="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500"
                                                            >
                                                                <option value="Alliance">Alliance</option>
                                                                <option value="AmeriHealth">AmeriHealth</option>
                                                                <option value="BCBS NC">BCBS NC</option>
                                                                <option value="Carolina Complete">Carolina Complete</option>
                                                                <option value="HealthyBlue">HealthyBlue</option>
                                                                <option value="Vaya">Vaya</option>
                                                                <option value="UHC">UHC</option>
                                                            </select>
                                                        </div>
                                                        
                                                        <div>
                                                            <label className="block text-sm font-medium text-slate-700 mb-2">Status</label>
                                                            <div className="flex items-center space-x-2">
                                                                {getStatusIcon(client.contracted, client.status)}
                                                                <input
                                                                    type="text"
                                                                    value={client.status}
                                                                    onChange={(e) => updateClient(client.id, 'status', e.target.value)}
                                                                    className="flex-1 p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500"
                                                                />
                                                            </div>
                                                        </div>
                                                        
                                                        <div className="flex items-end justify-between">
                                                            <div>
                                                                <label className="block text-sm font-medium text-slate-700 mb-2">Contracted</label>
                                                                <div className="flex items-center">
                                                                    <input
                                                                        type="checkbox"
                                                                        checked={client.contracted}
                                                                        onChange={(e) => updateClient(client.id, 'contracted', e.target.checked)}
                                                                        className="h-5 w-5 text-rose-600 rounded focus:ring-rose-500"
                                                                    />
                                                                    <span className={`ml-2 text-sm font-medium ${client.contracted ? 'text-green-600' : 'text-red-600'}`}>
                                                                        {client.contracted ? 'Active' : 'Inactive'}
                                                                    </span>
                                                                </div>
                                                            </div>
                                                            <button
                                                                onClick={() => removeClient(client.id)}
                                                                className="p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors"
                                                            >
                                                                {React.createElement(Trash2, {className: "h-5 w-5"})}
                                                            </button>
                                                        </div>
                                                        
                                                        <div className="lg:col-span-6">
                                                            <label className="block text-sm font-medium text-slate-700 mb-2 flex items-center">
                                                                {React.createElement(FileText, {className: "h-4 w-4 mr-2"})}
                                                                Special Notes
                                                            </label>
                                                            <textarea
                                                                value={client.specialNotes}
                                                                onChange={(e) => updateClient(client.id, 'specialNotes', e.target.value)}
                                                                className="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-500 focus:border-rose-500"
                                                                rows="3"
                                                                placeholder="Add any special notes, alerts, or important information about this client..."
                                                            />
                                                        </div>
                                                    </div>
                                                    
                                                    <div className="flex items-center justify-between mt-4 pt-4 border-t border-slate-200">
                                                        <div className="flex items-center space-x-3">
                                                            <span className={`px-3 py-1 rounded-full text-sm font-medium ${getServiceTypeColor(client.serviceType)}`}>
                                                                {client.serviceType}
                                                            </span>
                                                            <span className={`px-3 py-1 rounded-full text-sm font-medium ${getInsuranceColor(client.insurance)}`}>
                                                                {client.insurance}
                                                            </span>
                                                        </div>
                                                        <div className="flex items-center space-x-2 text-sm text-slate-500">
                                                            {getStatusIcon(client.contracted, client.status)}
                                                            <span>ID: {client.id}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {selectedTab === 'billing' && (
                                    <div>
                                        <div className="flex justify-between items-center mb-6">
                                            <h2 className="text-2xl font-bold text-slate-800">Weekly Service Tracking & Billing</h2>
                                            <div className="flex space-x-3">
                                                <input
                                                    type="date"
                                                    value={currentWeek}
                                                    onChange={(e) => setCurrentWeek(e.target.value)}
                                                    className="px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-rose-500 focus:border-rose-500"
                                                />
                                                {weeklyData.length > 0 && (
                                                    <select
                                                        value={selectedWeekIndex}
                                                        onChange={(e) => setSelectedWeekIndex(parseInt(e.target.value))}
                                                        className="px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-rose-500 focus:border-rose-500 bg-white"
                                                    >
                                                        {weeklyData.map((week, index) => (
                                                            <option key={index} value={index}>
                                                                Week of {new Date(week.weekStart).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} - {new Date(week.weekEnd).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
                                                            </option>
                                                        ))}
                                                    </select>
                                                )}
                                                <button
                                                    onClick={addWeek}
                                                    className="flex items-center px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl hover:from-green-600 hover:to-green-700 shadow-lg transition-all duration-200"
                                                >
                                                    {React.createElement(Plus, {className: "h-5 w-5 mr-2"})}
                                                    Add Week
                                                </button>
                                                <button
                                                    onClick={toggleFinancialVisibility}
                                                    className={`flex items-center px-6 py-3 ${
                                                        showFinancials 
                                                            ? 'bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700' 
                                                            : 'bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700'
                                                    } text-white rounded-xl shadow-lg transition-all duration-200`}
                                                >
                                                    {showFinancials ? (
                                                        <>
                                                            {React.createElement(EyeOff, {className: "h-5 w-5 mr-2"})}
                                                            Hide Financials
                                                        </>
                                                    ) : (
                                                        <>
                                                            {React.createElement(Lock, {className: "h-5 w-5 mr-2"})}
                                                            Show Financials
                                                        </>
                                                    )}
                                                </button>
                                                <button
                                                    onClick={clearFinancialData}
                                                    className="flex items-center px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl hover:from-red-600 hover:to-red-700 shadow-lg transition-all duration-200"
                                                >
                                                    {React.createElement(RotateCcw, {className: "h-5 w-5 mr-2"})}
                                                    Clear Financial Data
                                                </button>
                                                <button
                                                    onClick={clearAllData}
                                                    className="flex items-center px-6 py-3 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-xl hover:from-gray-600 hover:to-gray-700 shadow-lg transition-all duration-200"
                                                >
                                                    {React.createElement(Database, {className: "h-5 w-5 mr-2"})}
                                                    Clear All Data
                                                </button>
                                            </div>
                                        </div>

                                        {weeklyData.length === 0 ? (
                                            <div className="text-center py-12">
                                                {React.createElement(Calendar, {className: "h-16 w-16 text-slate-400 mx-auto mb-4"})}
                                                <h4 className="text-xl font-semibold text-slate-600 mb-2">No Weekly Data Yet</h4>
                                                <p className="text-slate-500 mb-6">Add your first week to start tracking services and billing.</p>
                                                <button
                                                    onClick={addWeek}
                                                    className="px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-200"
                                                >
                                                    Add First Week
                                                </button>
                                            </div>
                                        ) : (
                                            weeklyData.length > 0 && selectedWeekIndex < weeklyData.length ? 
                                            weeklyData
                                                .filter((_, index) => index === selectedWeekIndex)
                                                .map((week, displayIndex) => {
                                                    const actualWeekIndex = selectedWeekIndex;
                                                    const weekTotals = calculateWeekTotals(week);
                                                    
                                                    return (
                                                        <div key={actualWeekIndex} className="mb-8 border rounded-2xl overflow-hidden shadow-lg border-slate-200 bg-white">
                                                            <div className="p-6 flex justify-between items-center bg-gradient-to-r from-slate-100 to-slate-200">
                                                                <div>
                                                                    <h3 className="text-xl font-bold text-slate-800">
                                                                        Week of {new Date(week.weekStart).toLocaleDateString('en-US', { month: 'long', day: 'numeric' })} - {new Date(week.weekEnd).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}
                                                                    </h3>
                                                                    <div className="flex space-x-6 mt-2">
                                                                        <span className="text-emerald-600 font-medium">
                                                                            {React.createElement(Clock, {className: "inline h-4 w-4 mr-1"})}
                                                                            SACOT: {weekTotals.sacotHours.toFixed(1)} hours
                                                                        </span>
                                                                        <span className="text-violet-600 font-medium">
                                                                            {React.createElement(Calendar, {className: "inline h-4 w-4 mr-1"})}
                                                                            SAIOP: {weekTotals.saiopDays} days
                                                                        </span>
                                                                        <span className="text-green-600 font-bold">
                                                                            {React.createElement(DollarSign, {className: "inline h-4 w-4 mr-1"})}
                                                                            {showFinancials ? `${weekTotals.totalBilling.toLocaleString('en-US', {minimumFractionDigits: 2})}` : '••••••'}
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                                <button
                                                                    onClick={() => removeWeek(actualWeekIndex)}
                                                                    className="p-3 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-xl transition-all duration-200"
                                                                >
                                                                    {React.createElement(Trash2, {className: "h-6 w-6"})}
                                                                </button>
                                                            </div>
                                                            
                                                            <div className="overflow-x-auto">
                                                                <table className="w-full">
                                                                    <thead>
                                                                        <tr className="bg-slate-50 border-b border-slate-200">
                                                                            <th className="text-left p-4 font-semibold text-slate-700">Client</th>
                                                                            <th className="text-center p-4 font-semibold text-slate-700">Service</th>
                                                                            <th className="text-center p-4 font-semibold text-slate-700">Mon</th>
                                                                            <th className="text-center p-4 font-semibold text-slate-700">Tue</th>
                                                                            <th className="text-center p-4 font-semibold text-slate-700">Wed</th>
                                                                            <th className="text-center p-4 font-semibold text-slate-700">Thu</th>
                                                                            <th className="text-center p-4 font-semibold text-slate-700">Fri</th>
                                                                            <th className="text-center p-4 font-semibold text-slate-700">Total</th>
                                                                            {showFinancials && <th className="text-center p-4 font-semibold text-slate-700">Billing</th>}
                                                                            <th className="text-center p-4 font-semibold text-slate-700">Payment Status</th>
                                                                            <th className="text-left p-4 font-semibold text-slate-700">Session Notes</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        {week.clients.map((client, clientIndex) => (
                                                                            <tr key={client.clientId} className="border-b border-slate-100 hover:bg-slate-50 transition-colors">
                                                                                <td className="p-4">
                                                                                    <div className="font-semibold text-slate-800">{client.name}</div>
                                                                                    <div className={`text-xs px-2 py-1 rounded-full inline-block mt-1 ${getInsuranceColor(client.insurance)}`}>
                                                                                        {client.insurance}
                                                                                    </div>
                                                                                </td>
                                                                                <td className="p-2">
                                                                                    <span className={`px-3 py-1 rounded-full text-sm font-medium ${getServiceTypeColor(client.serviceType)}`}>
                                                                                        {client.serviceType}
                                                                                    </span>
                                                                                </td>
                                                                                {client.serviceType === 'SACOT' ? (
                                                                                    // SACOT Hours Input
                                                                                    <>
                                                                                        {['monday', 'tuesday', 'wednesday', 'thursday', 'friday'].map((day) => (
                                                                                            <td key={day} className="p-2">
                                                                                                <input
                                                                                                    type="number"
                                                                                                    step="0.5"
                                                                                                    min="0"
                                                                                                    max="8"
                                                                                                    value={client[`${day}Value`] || 0}
                                                                                                    onChange={(e) => updateClientValue(actualWeekIndex, clientIndex, day, e.target.value)}
                                                                                                    className="w-20 p-2 text-center border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"
                                                                                                    placeholder="hrs"
                                                                                                />
                                                                                            </td>
                                                                                        ))}
                                                                                        <td className="p-4 text-center">
                                                                                            <span className="font-bold text-lg text-emerald-600">{client.totalValue || 0} hrs</span>
                                                                                        </td>
                                                                                    </>
                                                                                ) : (
                                                                                    // SAIOP Attendance Input
                                                                                    <>
                                                                                        {['monday', 'tuesday', 'wednesday', 'thursday', 'friday'].map((day) => (
                                                                                            <td key={day} className="p-2">
                                                                                                <div className="flex justify-center">
                                                                                                    <input
                                                                                                        type="checkbox"
                                                                                                        checked={client[`${day}Value`] || false}
                                                                                                        onChange={(e) => updateClientValue(actualWeekIndex, clientIndex, day, e.target.checked)}
                                                                                                        className="h-5 w-5 text-violet-600 rounded focus:ring-violet-500"
                                                                                                    />
                                                                                                </div>
                                                                                            </td>
                                                                                        ))}
                                                                                        <td className="p-4 text-center">
                                                                                            <span className="font-bold text-lg text-violet-600">{client.totalValue || 0} days</span>
                                                                                        </td>
                                                                                    </>
                                                                                )}
                                                                                {showFinancials && (
                                                                                    <td className="p-4 text-center">
                                                                                        <span className="font-bold text-lg text-green-600">
                                                                                            ${(client.billing || 0).toLocaleString('en-US', {minimumFractionDigits: 2})}
                                                                                        </span>
                                                                                    </td>
                                                                                )}
                                                                                <td className="p-2">
                                                                                    <select
                                                                                        value={client.paymentStatus || 'Pending'}
                                                                                        onChange={(e) => updatePaymentStatus(actualWeekIndex, clientIndex, e.target.value)}
                                                                                        className={`w-full p-2 rounded-lg text-sm font-medium border focus:ring-2 focus:ring-blue-500 ${
                                                                                            getPaymentStatusColor(client.paymentStatus || 'Pending')
                                                                                        }`}
                                                                                    >
                                                                                        <option value="Pending">Pending</option>
                                                                                        <option value="Paid">Paid</option>
                                                                                        <option value="Denied">Denied</option>
                                                                                    </select>
                                                                                </td>
                                                                                <td className="p-2">
                                                                                    <textarea
                                                                                        value={client.notes || ''}
                                                                                        onChange={(e) => updateClientNotes(actualWeekIndex, clientIndex, e.target.value)}
                                                                                        className="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"
                                                                                        rows="2"
                                                                                        placeholder={`${client.serviceType} session notes...`}
                                                                                    />
                                                                                </td>
                                                                            </tr>
                                                                        ))}
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    );
                                                }) : null
                                        )}
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(React.createElement(LifeAbundantlyBillingSystem), document.getElementById('root'));
    </script>
    <style>
        /* iPad Pro Fix for Contracted/Active Overlap */
        @media screen and (min-width: 768px) {
            .bg-slate-50.rounded-xl.p-6 .flex.items-end.justify-between {
                display: block !important;
            }
            
            .bg-slate-50.rounded-xl.p-6 .flex.items-end.justify-between > div:first-child {
                margin-bottom: 1rem !important;
                display: flex !important;
                align-items: center !important;
                gap: 0.5rem !important;
            }
            
            .bg-slate-50.rounded-xl.p-6 .flex.items-end.justify-between > button {
                float: right !important;
                margin-top: -2rem !important;
            }
        }
    </style>
</body>
</html>
